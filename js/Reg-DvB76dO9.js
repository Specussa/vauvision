import{d as W,b as D,Z as w,c as u,a as s,U as f,O as g,u as V,S as N,I as c,T as y,R as v,P as $,ag as I,ai as P,o as n,M as S}from"./@vue-DwLU1mub.js";import{_ as q}from"./auth-D_GbeW7X.js";import{v as R,h as F}from"./@element-plus-m0wAbjkV.js";import{s as H,a as J}from"./api-DCacf_kA.js";import{r as K,T as E,_ as Q}from"./index-BGeyuqtG.js";import{L as X}from"./Logo-BoKzTO4B.js";import{B as L}from"./BackSVG-DnQE1F6r.js";import{E as z}from"./element-plus-3NUcAjFf.js";import"./axios-BimPEqV4.js";import"./vue-router-CPimp6oI.js";import"./vue-i18n-DcgfqTZL.js";import"./@intlify-CQT3u4ju.js";import"./vue-tel-input-BsVA42h1.js";import"./lodash-es-CiJSjksT.js";import"./@vueuse-Q_cOxmjC.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-Ct2Knyoi.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DF51-gJp.js";const Y={class:"auth"},ee={class:"auth__container container"},se={class:"auth__block"},ae={class:"auth__flex"},le={class:"auth__left"},oe={class:"auth__left_left"},re={class:"auth__logo"},te={class:"auth__right"},ie={class:"auth__top"},ne={key:0,class:"auth__form"},de={class:"form__flex"},me={class:"form__group"},ue={key:0,class:"error text_very"},pe={class:"form__group"},_e={key:0,class:"error text_very"},fe={class:"form__group"},ce={key:0,class:"error text_very"},ve={class:"form__buttons"},ye=["disabled"],be={key:1,class:"auth__form"},Ne={class:"form__flex"},xe={class:"form__group"},ge={class:"form__labels"},we={class:"form__label_radio"},ke={class:"form__label_radio"},Ve={key:0,class:"error text_very"},he={key:0,class:"form__group"},Ae={key:0,class:"error text_very"},Ce={key:1,class:"form__group"},Te={key:0,class:"error text_very"},De={class:"form__buttons"},Pe=["disabled"],Se=["disabled"],ze={key:2,class:"auth__form"},Be={class:"form__flex"},Ue={class:"form__group"},$e={key:0,class:"error text_very"},Ie={class:"form__group"},Re={key:0,class:"error text_very"},Fe={class:"form__group"},Ee={key:0,class:"error text_very"},Le={class:"form__group"},Oe={key:0,class:"error text_very"},Me={class:"form__group"},je={class:"form__checkboxes"},Ze={key:0,class:"error text_very"},Ge={key:1,class:"error text_very"},We={class:"form__buttons"},qe=["disabled"],He=["disabled"],Je={key:0},Ke={key:1},Qe={class:"form__step"},Xe=W({__name:"Reg",setup(Ye){const x=D(1),p=w({firstName:"",lastName:"",referralCode:""}),d=w({userType:"executor",executorName:"",labelName:""}),r=w({email:"",phone:"",password:"",confirmPassword:"",personalData:!1,marketing:!1,policy:!1}),i=w({firstName:"",lastName:"",referralCode:""}),_=w({userType:"",executorName:"",labelName:""}),l=w({email:"",phone:"",password:"",confirmPassword:"",personalData:"",policy:""}),h=D(!1),A=D(!1),m=D(!1),C=()=>{let t=!0;return i.firstName="",i.lastName="",i.referralCode="",p.firstName.trim()?p.firstName.trim().length<2?(i.firstName="Имя должно содержать минимум 2 символа",t=!1):/^[a-zA-Zа-яА-ЯёЁ\s\-]+$/.test(p.firstName.trim())||(i.firstName="Имя может содержать только буквы, пробелы и дефисы",t=!1):(i.firstName="Имя обязательно для заполнения",t=!1),p.lastName.trim()&&p.lastName.trim().length<2?(i.lastName="Фамилия должна содержать минимум 2 символа",t=!1):p.lastName.trim()&&!/^[a-zA-Zа-яА-ЯёЁ\s\-]+$/.test(p.lastName.trim())&&(i.lastName="Фамилия может содержать только буквы, пробелы и дефисы",t=!1),p.referralCode.trim()&&p.referralCode.trim().length<3&&(i.referralCode="Реферальный код должен содержать минимум 3 символа",t=!1),t},B=()=>{let t=!0;return _.userType="",_.executorName="",_.labelName="",d.userType||(_.userType="Выберите тип пользователя",t=!1),d.userType==="executor"&&!d.executorName.trim()&&(_.executorName="Имя исполнителя обязательно",t=!1),d.userType==="label"&&!d.labelName.trim()&&(_.labelName="Название лейбла обязательно",t=!1),t},k=()=>{let t=!0;if(l.email="",l.phone="",l.password="",l.confirmPassword="",l.personalData="",l.policy="",r.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email.trim())||(l.email="Введите корректный email адрес",t=!1):(l.email="Email обязателен для заполнения",t=!1),r.phone.trim()?/^[\d\s\-\+\(\)]+$/.test(r.phone.trim())||(l.phone="Введите корректный номер телефона",t=!1):(l.phone="Номер телефона обязателен",t=!1),!r.password)l.password="Пароль обязателен",t=!1;else if(r.password.length<6)l.password="Пароль должен содержать минимум 6 символов",t=!1;else{const e=/[A-Z]/.test(r.password),a=/[a-z]/.test(r.password),b=/\d/.test(r.password),T=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(r.password);(!e||!a||!b||!T)&&(l.password="Пароль должен содержать заглавные и строчные буквы, цифры и специальные символы",t=!1)}return r.confirmPassword?r.password!==r.confirmPassword&&(l.confirmPassword="Пароли не совпадают",t=!1):(l.confirmPassword="Подтверждение пароля обязательно",t=!1),r.personalData||(l.personalData="Необходимо согласие на обработку персональных данных",t=!1),r.policy||(l.policy="Необходимо согласие с политикой конфиденциальности",t=!1),t},O=()=>{C()&&(x.value=2)},M=()=>{B()&&(x.value=3)},j=()=>{x.value=1},Z=()=>{x.value=2},G=async()=>{if(!k())return;m.value=!0;const t={FIRST_NAME:p.firstName.trim(),LAST_NAME:p.lastName.trim()||null,REF:p.referralCode.trim()||null,user_type:d.userType,...d.userType==="executor"?{executor_name:d.executorName.trim()}:{label_name:d.labelName.trim()},EMAIL:r.email.trim(),TEL:r.phone.trim(),PASSWORD:r.password,CONFIRM_PASSWORD:r.confirmPassword,personal:r.personalData,security:r.marketing,policy:r.policy};await H("post","/ajax/auth/register.php",t).then(e=>{console.log("Успешная регистрация:",e.data),z({message:"Регистрация успешно завершена!",type:"success"}),e.data.access&&e.data.refresh&&J(e.data.access,e.data.refresh),Object.assign(p,{firstName:"",lastName:"",referralCode:""}),Object.assign(d,{userType:"executor",executorName:"",labelName:""}),Object.assign(r,{email:"",phone:"",password:"",confirmPassword:"",personalData:!1,marketing:!1,policy:!1}),x.value=1,K.push(E.i18nRoute({name:"login"}))}).catch(e=>{if(console.error("Ошибка при регистрации:",e),e.response&&e.response.data){const a=e.response.data;a.first_name&&(i.firstName=Array.isArray(a.first_name)?a.first_name[0]:a.first_name),a.last_name&&(i.lastName=Array.isArray(a.last_name)?a.last_name[0]:a.last_name),a.referral_code&&(i.referralCode=Array.isArray(a.referral_code)?a.referral_code[0]:a.referral_code),a.user_type&&(_.userType=Array.isArray(a.user_type)?a.user_type[0]:a.user_type),a.executor_name&&(_.executorName=Array.isArray(a.executor_name)?a.executor_name[0]:a.executor_name),a.label_name&&(_.labelName=Array.isArray(a.label_name)?a.label_name[0]:a.label_name),a.email&&(l.email=Array.isArray(a.email)?a.email[0]:a.email),a.phone&&(l.phone=Array.isArray(a.phone)?a.phone[0]:a.phone),a.password&&(l.password=Array.isArray(a.password)?a.password[0]:a.password),a.personal_data_consent&&(l.personalData=Array.isArray(a.personal_data_consent)?a.personal_data_consent[0]:a.personal_data_consent),a.privacy_policy_consent&&(l.policy=Array.isArray(a.privacy_policy_consent)?a.privacy_policy_consent[0]:a.privacy_policy_consent),!Object.keys(a).length&&a.detail?z({message:a.detail,type:"error"}):a.non_field_errors&&z({message:Array.isArray(a.non_field_errors)?a.non_field_errors[0]:a.non_field_errors,type:"error"})}else z({message:"Произошла ошибка при регистрации. Попробуйте еще раз.",type:"error"})}).finally(()=>{m.value=!1})};return(t,e)=>{const a=P("RouterLink"),b=P("el-input"),T=P("el-icon"),U=P("el-checkbox");return n(),u("section",Y,[s("div",ee,[s("div",se,[s("div",ae,[s("div",le,[s("div",oe,[s("div",re,[f(X)]),e[25]||(e[25]=s("div",{class:"auth__info"},[s("h3",{class:"auth__heading"},"Стань известным и популярным в мире музыки"),s("p",{class:"auth__description"},"Выложи трек на все площадки и продавай свою музыку во всем мире")],-1))]),e[26]||(e[26]=s("div",{class:"auth__image"},[s("img",{src:q,alt:"cover"})],-1))]),s("div",te,[s("div",ie,[e[28]||(e[28]=s("p",{class:"auth__acc text_small"},"У вас уже есть аккаунт?",-1)),f(a,{class:"auth__login button__second button",to:V(E).i18nRoute({name:"login"})},{default:g(()=>e[27]||(e[27]=[s("span",null,"Войти",-1)])),_:1},8,["to"])]),x.value===1?(n(),u("div",ne,[e[34]||(e[34]=s("div",{class:"form__heading"},[s("h1",{class:"form__head title_two"},"Регистрация")],-1)),s("div",de,[s("div",me,[e[29]||(e[29]=s("label",{for:"firstName",class:"form__label button"},[N("Ваше имя"),s("span",null,"*")],-1)),f(b,{id:"firstName",modelValue:p.firstName,"onUpdate:modelValue":e[0]||(e[0]=o=>p.firstName=o),type:"text",class:c({error:i.firstName}),placeholder:"Введите ваше имя",disabled:m.value,onBlur:C,onInput:e[1]||(e[1]=o=>i.firstName=""),size:"large"},null,8,["modelValue","class","disabled"]),i.firstName?(n(),u("div",ue,y(i.firstName),1)):v("",!0)]),s("div",pe,[e[30]||(e[30]=s("label",{for:"lastName",class:"form__label button"},"Ваша фамилия",-1)),f(b,{id:"lastName",modelValue:p.lastName,"onUpdate:modelValue":e[2]||(e[2]=o=>p.lastName=o),type:"text",class:c({error:i.lastName}),placeholder:"Введите вашу фамилию",disabled:m.value,onBlur:C,onInput:e[3]||(e[3]=o=>i.lastName=""),size:"large"},null,8,["modelValue","class","disabled"]),i.lastName?(n(),u("div",_e,y(i.lastName),1)):v("",!0)]),s("div",fe,[e[31]||(e[31]=s("label",{for:"referralCode",class:"form__label button"},"Реферальный код",-1)),e[32]||(e[32]=s("div",{class:"form__hint text_small"}," Если у вас нет кода или почты партнёра, оставьте это поле пустым. ",-1)),f(b,{id:"referralCode",modelValue:p.referralCode,"onUpdate:modelValue":e[4]||(e[4]=o=>p.referralCode=o),type:"text",class:c({error:i.referralCode}),placeholder:"Введите код",disabled:m.value,onBlur:C,onInput:e[5]||(e[5]=o=>i.referralCode=""),size:"large"},null,8,["modelValue","class","disabled"]),i.referralCode?(n(),u("div",ce,y(i.referralCode),1)):v("",!0)])]),s("div",ve,[s("button",{class:"form__send button__black button",onClick:O,disabled:m.value},e[33]||(e[33]=[s("span",null,"Продолжить",-1)]),8,ye)])])):x.value===2?(n(),u("div",be,[e[44]||(e[44]=s("div",{class:"form__heading"},[s("h1",{class:"form__head title_two"},"Выберите тип аккаунта")],-1)),s("div",Ne,[s("div",xe,[e[37]||(e[37]=s("label",{class:"form__label button"},[N("Тип учетной записи"),s("span",null,"*")],-1)),e[38]||(e[38]=s("p",{class:"form__desc text_small"}," Выбирайте «Исполнитель», если вы один артист с одним псевдонимом. Выбирайте «Лейбл», если собираетесь загружать много релизов от разных артистов. ",-1)),s("div",ge,[s("label",we,[$(s("input",{type:"radio","onUpdate:modelValue":e[6]||(e[6]=o=>d.userType=o),value:"executor",class:"form__radio_input"},null,512),[[I,d.userType]]),e[35]||(e[35]=s("span",{class:"form__radio_text"},"Исполнитель",-1))]),s("label",ke,[$(s("input",{type:"radio","onUpdate:modelValue":e[7]||(e[7]=o=>d.userType=o),value:"label",class:"form__radio_input"},null,512),[[I,d.userType]]),e[36]||(e[36]=s("span",{class:"form__radio_text"},"Лейбл",-1))])]),_.userType?(n(),u("div",Ve,y(_.userType),1)):v("",!0),e[39]||(e[39]=s("p",{class:"form__description text_very"}," Пожалуйста, впишите именно ПСЕВДОНИМ АРТИСТА, под которым будут выкладываться релизы. Если вы планируете публиковать релизы от разных псевдонимов, то сделайте несколько профилей из расчёта «1 профиль = 1 псевдоним», либо аккаунт лейбла. ",-1))]),d.userType==="executor"?(n(),u("div",he,[e[40]||(e[40]=s("label",{class:"form__label button"},[N("Имя исполнителя"),s("span",null,"*")],-1)),f(b,{modelValue:d.executorName,"onUpdate:modelValue":e[8]||(e[8]=o=>d.executorName=o),type:"text",class:c({error:_.executorName}),placeholder:"Введите имя исполнителя",disabled:m.value,onBlur:B,onInput:e[9]||(e[9]=o=>_.executorName=""),size:"large"},null,8,["modelValue","class","disabled"]),_.executorName?(n(),u("div",Ae,y(_.executorName),1)):v("",!0)])):v("",!0),d.userType==="label"?(n(),u("div",Ce,[e[41]||(e[41]=s("label",{class:"form__label button"},[N("Имя лейбла"),s("span",null,"*")],-1)),f(b,{modelValue:d.labelName,"onUpdate:modelValue":e[10]||(e[10]=o=>d.labelName=o),type:"text",class:c({error:_.labelName}),placeholder:"Введите название лейбла",disabled:m.value,onBlur:B,onInput:e[11]||(e[11]=o=>_.labelName=""),size:"large"},null,8,["modelValue","class","disabled"]),_.labelName?(n(),u("div",Te,y(_.labelName),1)):v("",!0)])):v("",!0)]),s("div",De,[s("button",{class:"form__back button__second button",onClick:j,disabled:m.value},[s("span",null,[f(L)]),e[42]||(e[42]=s("span",null,"Назад",-1))],8,Pe),s("button",{class:"form__send button__black button",onClick:M,disabled:m.value},e[43]||(e[43]=[s("span",null,"Продолжить",-1)]),8,Se)])])):(n(),u("div",ze,[e[53]||(e[53]=s("div",{class:"form__heading"},[s("h1",{class:"form__head title_two"},"Контактные данные")],-1)),s("div",Be,[s("div",Ue,[e[45]||(e[45]=s("label",{for:"email",class:"form__label button"},[N("Электронная почта"),s("span",null,"*")],-1)),f(b,{id:"email",modelValue:r.email,"onUpdate:modelValue":e[12]||(e[12]=o=>r.email=o),type:"email",class:c({error:l.email}),placeholder:"Введите ваш e-mail",disabled:m.value,onBlur:k,onInput:e[13]||(e[13]=o=>l.email=""),size:"large"},null,8,["modelValue","class","disabled"]),l.email?(n(),u("div",$e,y(l.email),1)):v("",!0)]),s("div",Ie,[e[46]||(e[46]=s("label",{for:"phone",class:"form__label button"},[N("Номер телефона"),s("span",null,"*")],-1)),f(b,{id:"phone",modelValue:r.phone,"onUpdate:modelValue":e[14]||(e[14]=o=>r.phone=o),type:"tel",class:c({error:l.phone}),placeholder:"Введите номер телефона",disabled:m.value,onBlur:k,onInput:e[15]||(e[15]=o=>l.phone=""),size:"large"},null,8,["modelValue","class","disabled"]),l.phone?(n(),u("div",Re,y(l.phone),1)):v("",!0)]),s("div",Fe,[e[47]||(e[47]=s("label",{for:"password",class:"form__label button"},[N("Пароль"),s("span",null,"*")],-1)),f(b,{id:"password",modelValue:r.password,"onUpdate:modelValue":e[17]||(e[17]=o=>r.password=o),type:h.value?"text":"password",class:c({error:l.password}),placeholder:"Введите пароль",disabled:m.value,onBlur:k,onInput:e[18]||(e[18]=o=>l.password=""),size:"large"},{suffix:g(()=>[f(T,{onClick:e[16]||(e[16]=o=>h.value=!h.value),style:{color:"var(--el-text-color-placeholder)",cursor:"pointer"}},{default:g(()=>[h.value?(n(),S(V(R),{key:0})):(n(),S(V(F),{key:1}))]),_:1})]),_:1},8,["modelValue","type","class","disabled"]),l.password?(n(),u("div",Ee,y(l.password),1)):v("",!0)]),s("div",Le,[e[48]||(e[48]=s("label",{for:"confirmPassword",class:"form__label button"},[N("Повторите пароль"),s("span",null,"*")],-1)),f(b,{id:"confirmPassword",modelValue:r.confirmPassword,"onUpdate:modelValue":e[20]||(e[20]=o=>r.confirmPassword=o),type:A.value?"text":"password",class:c({error:l.confirmPassword}),placeholder:"Повторите пароль",disabled:m.value,onBlur:k,onInput:e[21]||(e[21]=o=>l.confirmPassword=""),size:"large"},{suffix:g(()=>[f(T,{onClick:e[19]||(e[19]=o=>A.value=!A.value),style:{color:"var(--el-text-color-placeholder)",cursor:"pointer"}},{default:g(()=>[A.value?(n(),S(V(R),{key:0})):(n(),S(V(F),{key:1}))]),_:1})]),_:1},8,["modelValue","type","class","disabled"]),l.confirmPassword?(n(),u("div",Oe,y(l.confirmPassword),1)):v("",!0)]),s("div",Me,[s("div",je,[f(U,{modelValue:r.personalData,"onUpdate:modelValue":e[22]||(e[22]=o=>r.personalData=o),disabled:m.value,class:c({error:l.personalData}),size:"large"},{default:g(()=>e[49]||(e[49]=[N(" Я даю согласие на обработку своих персональных данных ")])),_:1},8,["modelValue","disabled","class"]),f(U,{modelValue:r.policy,"onUpdate:modelValue":e[23]||(e[23]=o=>r.policy=o),disabled:m.value,class:c({error:l.policy}),size:"large"},{default:g(()=>e[50]||(e[50]=[N(" Я соглашаюсь с "),s("a",{href:"/policy",target:"_blank",class:"policy-link"},"Политикой конфиденциальности",-1)])),_:1},8,["modelValue","disabled","class"]),f(U,{modelValue:r.marketing,"onUpdate:modelValue":e[24]||(e[24]=o=>r.marketing=o),disabled:m.value,size:"large"},{default:g(()=>e[51]||(e[51]=[N(" Я даю согласие на рекламную рассылку ")])),_:1},8,["modelValue","disabled"])]),l.personalData?(n(),u("div",Ze,y(l.personalData),1)):v("",!0),l.policy?(n(),u("div",Ge,y(l.policy),1)):v("",!0)])]),s("div",We,[s("button",{class:"form__back button__second button",onClick:Z,disabled:m.value},[s("span",null,[f(L)]),e[52]||(e[52]=s("span",null,"Назад",-1))],8,qe),s("button",{class:"form__send button__black button",onClick:G,disabled:m.value},[m.value?(n(),u("span",Ke,"Загрузка...")):(n(),u("span",Je,"Зарегистрироваться"))],8,He)])])),s("div",Qe,[s("span",{class:c({active:x.value>=1})},null,2),s("span",{class:c({active:x.value>=2})},null,2),s("span",{class:c({active:x.value>=3})},null,2)])])])])])])}}}),ws=Q(Xe,[["__scopeId","data-v-64032ea6"]]);export{ws as default};
