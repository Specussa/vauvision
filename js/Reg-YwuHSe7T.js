import{d as q,b as P,Z as w,c as p,a as s,U as f,O as x,u as V,S as N,I as c,T as y,R as v,P as $,ag as F,ai as D,o as n,M as S}from"./@vue-DwLU1mub.js";import{_ as H}from"./auth-D_GbeW7X.js";import{v as I,h as E}from"./@element-plus-m0wAbjkV.js";import{s as J,a as K}from"./api-dDMw0Exz.js";import{r as Q,T as L,_ as X}from"./index-DLLIllaA.js";import{L as Y}from"./Logo-BjNREyvW.js";import{B as O}from"./BackSVG-B1-ysIII.js";import{E as U}from"./element-plus-3NUcAjFf.js";import"./axios-BimPEqV4.js";import"./vue-router-CPimp6oI.js";import"./vue-i18n-DcgfqTZL.js";import"./@intlify-CQT3u4ju.js";import"./vue-tel-input-BsVA42h1.js";import"./lodash-es-CiJSjksT.js";import"./@vueuse-Q_cOxmjC.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-Ct2Knyoi.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DF51-gJp.js";const ee={class:"auth"},se={class:"auth__container container"},ae={class:"auth__block"},le={class:"auth__flex"},oe={class:"auth__left"},re={class:"auth__left_left"},te={class:"auth__logo"},ie={class:"auth__right"},ne={class:"auth__top"},de={key:0,class:"auth__form"},me={class:"form__flex"},ue={class:"form__group"},pe={key:0,class:"error text_very"},_e={class:"form__group"},fe={key:0,class:"error text_very"},ce={class:"form__group"},ve={key:0,class:"error text_very"},ye={class:"form__buttons"},be=["disabled"],Ne={key:1,class:"auth__form"},ge={class:"form__flex"},xe={class:"form__group"},we={class:"form__labels"},ke={class:"form__label_radio"},Ve={class:"form__label_radio"},he={key:0,class:"error text_very"},Ce={key:0,class:"form__group"},Ae={key:0,class:"error text_very"},Te={key:1,class:"form__group"},Pe={key:0,class:"error text_very"},De={class:"form__buttons"},Se=["disabled"],Ue=["disabled"],Re={key:2,class:"auth__form"},ze={class:"form__flex"},Be={class:"form__group"},$e={key:0,class:"error text_very"},Fe={class:"form__group"},Ie={key:0,class:"error text_very"},Ee={class:"form__group"},Le={key:0,class:"error text_very"},Oe={class:"form__group"},Me={key:0,class:"error text_very"},je={class:"form__group"},Ze={class:"form__checkboxes"},Ge={key:0,class:"error text_very"},We={key:1,class:"error text_very"},qe={class:"form__buttons"},He=["disabled"],Je=["disabled"],Ke={key:0},Qe={key:1},Xe={class:"form__step"},Ye=q({__name:"Reg",setup(es){const g=P(1),d=w({firstName:"",lastName:"",referralCode:""}),m=w({userType:"executor",executorName:"",labelName:""}),r=w({email:"",phone:"",password:"",confirmPassword:"",personalData:!1,marketing:!1,policy:!1}),i=w({firstName:"",lastName:"",referralCode:""}),_=w({userType:"",executorName:"",labelName:""}),l=w({email:"",phone:"",password:"",confirmPassword:"",personalData:"",policy:""}),B=new URLSearchParams(window.location.search).get("ref")||"";B&&(d.referralCode=B);const h=P(!1),C=P(!1),u=P(!1),A=()=>{let t=!0;return i.firstName="",i.lastName="",i.referralCode="",d.firstName.trim()?d.firstName.trim().length<2?(i.firstName="Имя должно содержать минимум 2 символа",t=!1):/^[a-zA-Zа-яА-ЯёЁ\s\-]+$/.test(d.firstName.trim())||(i.firstName="Имя может содержать только буквы, пробелы и дефисы",t=!1):(i.firstName="Имя обязательно для заполнения",t=!1),d.lastName.trim()&&d.lastName.trim().length<2?(i.lastName="Фамилия должна содержать минимум 2 символа",t=!1):d.lastName.trim()&&!/^[a-zA-Zа-яА-ЯёЁ\s\-]+$/.test(d.lastName.trim())&&(i.lastName="Фамилия может содержать только буквы, пробелы и дефисы",t=!1),d.referralCode.trim()&&d.referralCode.trim().length<3&&(i.referralCode="Реферальный код должен содержать минимум 3 символа",t=!1),t},R=()=>{let t=!0;return _.userType="",_.executorName="",_.labelName="",m.userType||(_.userType="Выберите тип пользователя",t=!1),m.userType==="executor"&&!m.executorName.trim()&&(_.executorName="Имя исполнителя обязательно",t=!1),m.userType==="label"&&!m.labelName.trim()&&(_.labelName="Название лейбла обязательно",t=!1),t},k=()=>{let t=!0;if(l.email="",l.phone="",l.password="",l.confirmPassword="",l.personalData="",l.policy="",r.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email.trim())||(l.email="Введите корректный email адрес",t=!1):(l.email="Email обязателен для заполнения",t=!1),r.phone.trim()?/^[\d\s\-\+\(\)]+$/.test(r.phone.trim())||(l.phone="Введите корректный номер телефона",t=!1):(l.phone="Номер телефона обязателен",t=!1),!r.password)l.password="Пароль обязателен",t=!1;else if(r.password.length<6)l.password="Пароль должен содержать минимум 6 символов",t=!1;else{const e=/[A-Z]/.test(r.password),a=/[a-z]/.test(r.password),b=/\d/.test(r.password),T=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(r.password);(!e||!a||!b||!T)&&(l.password="Пароль должен содержать заглавные и строчные буквы, цифры и специальные символы",t=!1)}return r.confirmPassword?r.password!==r.confirmPassword&&(l.confirmPassword="Пароли не совпадают",t=!1):(l.confirmPassword="Подтверждение пароля обязательно",t=!1),r.personalData||(l.personalData="Необходимо согласие на обработку персональных данных",t=!1),r.policy||(l.policy="Необходимо согласие с политикой конфиденциальности",t=!1),t},M=()=>{A()&&(g.value=2)},j=()=>{R()&&(g.value=3)},Z=()=>{g.value=1},G=()=>{g.value=2},W=async()=>{if(!k())return;u.value=!0;const t={FIRST_NAME:d.firstName.trim(),LAST_NAME:d.lastName.trim()||null,REF:d.referralCode.trim()||null,user_type:m.userType,...m.userType==="executor"?{lable:m.executorName.trim()}:{lable2:m.labelName.trim()},EMAIL:r.email.trim(),TEL:r.phone.trim(),PASSWORD:r.password,CONFIRM_PASSWORD:r.confirmPassword,personal:r.personalData?"on":"off",security:r.marketing?"on":"off",policy:r.policy?"on":"off"};await J("post","/ajax/auth/register.php",t).then(e=>{console.log("Успешная регистрация:",e.data),U({message:"Регистрация успешно завершена!",type:"success"}),e.data.access&&e.data.refresh&&K(e.data.access,e.data.refresh),Object.assign(d,{firstName:"",lastName:"",referralCode:""}),Object.assign(m,{userType:"executor",executorName:"",labelName:""}),Object.assign(r,{email:"",phone:"",password:"",confirmPassword:"",personalData:!1,marketing:!1,policy:!1}),g.value=1,Q.push(L.i18nRoute({name:"login"}))}).catch(e=>{if(console.error("Ошибка при регистрации:",e),e.response&&e.response.data){const a=e.response.data;a.first_name&&(i.firstName=Array.isArray(a.first_name)?a.first_name[0]:a.first_name),a.last_name&&(i.lastName=Array.isArray(a.last_name)?a.last_name[0]:a.last_name),a.referral_code&&(i.referralCode=Array.isArray(a.referral_code)?a.referral_code[0]:a.referral_code),a.user_type&&(_.userType=Array.isArray(a.user_type)?a.user_type[0]:a.user_type),a.executor_name&&(_.executorName=Array.isArray(a.executor_name)?a.executor_name[0]:a.executor_name),a.label_name&&(_.labelName=Array.isArray(a.label_name)?a.label_name[0]:a.label_name),a.email&&(l.email=Array.isArray(a.email)?a.email[0]:a.email),a.phone&&(l.phone=Array.isArray(a.phone)?a.phone[0]:a.phone),a.password&&(l.password=Array.isArray(a.password)?a.password[0]:a.password),a.personal_data_consent&&(l.personalData=Array.isArray(a.personal_data_consent)?a.personal_data_consent[0]:a.personal_data_consent),a.privacy_policy_consent&&(l.policy=Array.isArray(a.privacy_policy_consent)?a.privacy_policy_consent[0]:a.privacy_policy_consent),!Object.keys(a).length&&a.detail?U({message:a.detail,type:"error"}):a.non_field_errors&&U({message:Array.isArray(a.non_field_errors)?a.non_field_errors[0]:a.non_field_errors,type:"error"})}else U({message:"Произошла ошибка при регистрации. Попробуйте еще раз.",type:"error"})}).finally(()=>{u.value=!1})};return(t,e)=>{const a=D("RouterLink"),b=D("el-input"),T=D("el-icon"),z=D("el-checkbox");return n(),p("section",ee,[s("div",se,[s("div",ae,[s("div",le,[s("div",oe,[s("div",re,[s("div",te,[f(Y)]),e[25]||(e[25]=s("div",{class:"auth__info"},[s("h3",{class:"auth__heading"},"Стань известным и популярным в мире музыки"),s("p",{class:"auth__description"},"Выложи трек на все площадки и продавай свою музыку во всем мире")],-1))]),e[26]||(e[26]=s("div",{class:"auth__image"},[s("img",{src:H,alt:"cover"})],-1))]),s("div",ie,[s("div",ne,[e[28]||(e[28]=s("p",{class:"auth__acc text_small"},"У вас уже есть аккаунт?",-1)),f(a,{class:"auth__login button__second button",to:V(L).i18nRoute({name:"login"})},{default:x(()=>e[27]||(e[27]=[s("span",null,"Войти",-1)])),_:1},8,["to"])]),g.value===1?(n(),p("div",de,[e[34]||(e[34]=s("div",{class:"form__heading"},[s("h1",{class:"form__head title_two"},"Регистрация")],-1)),s("div",me,[s("div",ue,[e[29]||(e[29]=s("label",{for:"firstName",class:"form__label button"},[N("Ваше имя"),s("span",null,"*")],-1)),f(b,{id:"firstName",modelValue:d.firstName,"onUpdate:modelValue":e[0]||(e[0]=o=>d.firstName=o),type:"text",class:c({error:i.firstName}),placeholder:"Введите ваше имя",disabled:u.value,onBlur:A,onInput:e[1]||(e[1]=o=>i.firstName=""),size:"large"},null,8,["modelValue","class","disabled"]),i.firstName?(n(),p("div",pe,y(i.firstName),1)):v("",!0)]),s("div",_e,[e[30]||(e[30]=s("label",{for:"lastName",class:"form__label button"},"Ваша фамилия",-1)),f(b,{id:"lastName",modelValue:d.lastName,"onUpdate:modelValue":e[2]||(e[2]=o=>d.lastName=o),type:"text",class:c({error:i.lastName}),placeholder:"Введите вашу фамилию",disabled:u.value,onBlur:A,onInput:e[3]||(e[3]=o=>i.lastName=""),size:"large"},null,8,["modelValue","class","disabled"]),i.lastName?(n(),p("div",fe,y(i.lastName),1)):v("",!0)]),s("div",ce,[e[31]||(e[31]=s("label",{for:"referralCode",class:"form__label button"},"Реферальный код",-1)),e[32]||(e[32]=s("div",{class:"form__hint text_small"}," Если у вас нет кода или почты партнёра, оставьте это поле пустым. ",-1)),f(b,{id:"referralCode",modelValue:d.referralCode,"onUpdate:modelValue":e[4]||(e[4]=o=>d.referralCode=o),type:"text",class:c({error:i.referralCode}),placeholder:"Введите код",disabled:u.value,onBlur:A,onInput:e[5]||(e[5]=o=>i.referralCode=""),size:"large"},null,8,["modelValue","class","disabled"]),i.referralCode?(n(),p("div",ve,y(i.referralCode),1)):v("",!0)])]),s("div",ye,[s("button",{class:"form__send button__black button",onClick:M,disabled:u.value},e[33]||(e[33]=[s("span",null,"Продолжить",-1)]),8,be)])])):g.value===2?(n(),p("div",Ne,[e[44]||(e[44]=s("div",{class:"form__heading"},[s("h1",{class:"form__head title_two"},"Выберите тип аккаунта")],-1)),s("div",ge,[s("div",xe,[e[37]||(e[37]=s("label",{class:"form__label button"},[N("Тип учетной записи"),s("span",null,"*")],-1)),e[38]||(e[38]=s("p",{class:"form__desc text_small"}," Выбирайте «Исполнитель», если вы один артист с одним псевдонимом. Выбирайте «Лейбл», если собираетесь загружать много релизов от разных артистов. ",-1)),s("div",we,[s("label",ke,[$(s("input",{type:"radio","onUpdate:modelValue":e[6]||(e[6]=o=>m.userType=o),value:"executor",class:"form__radio_input"},null,512),[[F,m.userType]]),e[35]||(e[35]=s("span",{class:"form__radio_text"},"Исполнитель",-1))]),s("label",Ve,[$(s("input",{type:"radio","onUpdate:modelValue":e[7]||(e[7]=o=>m.userType=o),value:"label",class:"form__radio_input"},null,512),[[F,m.userType]]),e[36]||(e[36]=s("span",{class:"form__radio_text"},"Лейбл",-1))])]),_.userType?(n(),p("div",he,y(_.userType),1)):v("",!0),e[39]||(e[39]=s("p",{class:"form__description text_very"}," Пожалуйста, впишите именно ПСЕВДОНИМ АРТИСТА, под которым будут выкладываться релизы. Если вы планируете публиковать релизы от разных псевдонимов, то сделайте несколько профилей из расчёта «1 профиль = 1 псевдоним», либо аккаунт лейбла. ",-1))]),m.userType==="executor"?(n(),p("div",Ce,[e[40]||(e[40]=s("label",{class:"form__label button"},[N("Имя исполнителя"),s("span",null,"*")],-1)),f(b,{modelValue:m.executorName,"onUpdate:modelValue":e[8]||(e[8]=o=>m.executorName=o),type:"text",class:c({error:_.executorName}),placeholder:"Введите имя исполнителя",disabled:u.value,onBlur:R,onInput:e[9]||(e[9]=o=>_.executorName=""),size:"large"},null,8,["modelValue","class","disabled"]),_.executorName?(n(),p("div",Ae,y(_.executorName),1)):v("",!0)])):v("",!0),m.userType==="label"?(n(),p("div",Te,[e[41]||(e[41]=s("label",{class:"form__label button"},[N("Имя лейбла"),s("span",null,"*")],-1)),f(b,{modelValue:m.labelName,"onUpdate:modelValue":e[10]||(e[10]=o=>m.labelName=o),type:"text",class:c({error:_.labelName}),placeholder:"Введите название лейбла",disabled:u.value,onBlur:R,onInput:e[11]||(e[11]=o=>_.labelName=""),size:"large"},null,8,["modelValue","class","disabled"]),_.labelName?(n(),p("div",Pe,y(_.labelName),1)):v("",!0)])):v("",!0)]),s("div",De,[s("button",{class:"form__back button__second button",onClick:Z,disabled:u.value},[s("span",null,[f(O)]),e[42]||(e[42]=s("span",null,"Назад",-1))],8,Se),s("button",{class:"form__send button__black button",onClick:j,disabled:u.value},e[43]||(e[43]=[s("span",null,"Продолжить",-1)]),8,Ue)])])):(n(),p("div",Re,[e[53]||(e[53]=s("div",{class:"form__heading"},[s("h1",{class:"form__head title_two"},"Контактные данные")],-1)),s("div",ze,[s("div",Be,[e[45]||(e[45]=s("label",{for:"email",class:"form__label button"},[N("Электронная почта"),s("span",null,"*")],-1)),f(b,{id:"email",modelValue:r.email,"onUpdate:modelValue":e[12]||(e[12]=o=>r.email=o),type:"email",class:c({error:l.email}),placeholder:"Введите ваш e-mail",disabled:u.value,onBlur:k,onInput:e[13]||(e[13]=o=>l.email=""),size:"large"},null,8,["modelValue","class","disabled"]),l.email?(n(),p("div",$e,y(l.email),1)):v("",!0)]),s("div",Fe,[e[46]||(e[46]=s("label",{for:"phone",class:"form__label button"},[N("Номер телефона"),s("span",null,"*")],-1)),f(b,{id:"phone",modelValue:r.phone,"onUpdate:modelValue":e[14]||(e[14]=o=>r.phone=o),type:"tel",class:c({error:l.phone}),placeholder:"Введите номер телефона",disabled:u.value,onBlur:k,onInput:e[15]||(e[15]=o=>l.phone=""),size:"large"},null,8,["modelValue","class","disabled"]),l.phone?(n(),p("div",Ie,y(l.phone),1)):v("",!0)]),s("div",Ee,[e[47]||(e[47]=s("label",{for:"password",class:"form__label button"},[N("Пароль"),s("span",null,"*")],-1)),f(b,{id:"password",modelValue:r.password,"onUpdate:modelValue":e[17]||(e[17]=o=>r.password=o),type:h.value?"text":"password",class:c({error:l.password}),placeholder:"Введите пароль",disabled:u.value,onBlur:k,onInput:e[18]||(e[18]=o=>l.password=""),size:"large"},{suffix:x(()=>[f(T,{onClick:e[16]||(e[16]=o=>h.value=!h.value),style:{color:"var(--el-text-color-placeholder)",cursor:"pointer"}},{default:x(()=>[h.value?(n(),S(V(I),{key:0})):(n(),S(V(E),{key:1}))]),_:1})]),_:1},8,["modelValue","type","class","disabled"]),l.password?(n(),p("div",Le,y(l.password),1)):v("",!0)]),s("div",Oe,[e[48]||(e[48]=s("label",{for:"confirmPassword",class:"form__label button"},[N("Повторите пароль"),s("span",null,"*")],-1)),f(b,{id:"confirmPassword",modelValue:r.confirmPassword,"onUpdate:modelValue":e[20]||(e[20]=o=>r.confirmPassword=o),type:C.value?"text":"password",class:c({error:l.confirmPassword}),placeholder:"Повторите пароль",disabled:u.value,onBlur:k,onInput:e[21]||(e[21]=o=>l.confirmPassword=""),size:"large"},{suffix:x(()=>[f(T,{onClick:e[19]||(e[19]=o=>C.value=!C.value),style:{color:"var(--el-text-color-placeholder)",cursor:"pointer"}},{default:x(()=>[C.value?(n(),S(V(I),{key:0})):(n(),S(V(E),{key:1}))]),_:1})]),_:1},8,["modelValue","type","class","disabled"]),l.confirmPassword?(n(),p("div",Me,y(l.confirmPassword),1)):v("",!0)]),s("div",je,[s("div",Ze,[f(z,{modelValue:r.personalData,"onUpdate:modelValue":e[22]||(e[22]=o=>r.personalData=o),disabled:u.value,class:c({error:l.personalData}),size:"large"},{default:x(()=>e[49]||(e[49]=[N(" Я даю согласие на обработку своих персональных данных ")])),_:1},8,["modelValue","disabled","class"]),f(z,{modelValue:r.policy,"onUpdate:modelValue":e[23]||(e[23]=o=>r.policy=o),disabled:u.value,class:c({error:l.policy}),size:"large"},{default:x(()=>e[50]||(e[50]=[N(" Я соглашаюсь с "),s("a",{href:"/policy",target:"_blank",class:"policy-link"},"Политикой конфиденциальности",-1)])),_:1},8,["modelValue","disabled","class"]),f(z,{modelValue:r.marketing,"onUpdate:modelValue":e[24]||(e[24]=o=>r.marketing=o),disabled:u.value,size:"large"},{default:x(()=>e[51]||(e[51]=[N(" Я даю согласие на рекламную рассылку ")])),_:1},8,["modelValue","disabled"])]),l.personalData?(n(),p("div",Ge,y(l.personalData),1)):v("",!0),l.policy?(n(),p("div",We,y(l.policy),1)):v("",!0)])]),s("div",qe,[s("button",{class:"form__back button__second button",onClick:G,disabled:u.value},[s("span",null,[f(O)]),e[52]||(e[52]=s("span",null,"Назад",-1))],8,He),s("button",{class:"form__send button__black button",onClick:W,disabled:u.value},[u.value?(n(),p("span",Qe,"Загрузка...")):(n(),p("span",Ke,"Зарегистрироваться"))],8,Je)])])),s("div",Xe,[s("span",{class:c({active:g.value>=1})},null,2),s("span",{class:c({active:g.value>=2})},null,2),s("span",{class:c({active:g.value>=3})},null,2)])])])])])])}}}),Vs=X(Ye,[["__scopeId","data-v-a262ddf9"]]);export{Vs as default};
