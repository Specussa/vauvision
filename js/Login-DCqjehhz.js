import{_ as L}from"./auth-D_GbeW7X.js";import{v as B,h as M}from"./@element-plus-m0wAbjkV.js";import{s as E}from"./api-dDMw0Exz.js";import{r as S,T as v}from"./index-DLLIllaA.js";import{L as z}from"./Logo-BjNREyvW.js";import{E as d}from"./element-plus-3NUcAjFf.js";import{d as D,Z as w,b as h,c as m,a as e,U as i,O as p,u,I as y,T as k,R as V,ai as f,o as n,M as x}from"./@vue-DwLU1mub.js";import"./axios-BimPEqV4.js";import"./vue-router-CPimp6oI.js";import"./vue-i18n-DcgfqTZL.js";import"./@intlify-CQT3u4ju.js";import"./vue-tel-input-BsVA42h1.js";import"./lodash-es-CiJSjksT.js";import"./@vueuse-Q_cOxmjC.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-Ct2Knyoi.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DF51-gJp.js";const I={class:"auth"},N={class:"auth__container container"},U={class:"auth__block"},$={class:"auth__flex"},O={class:"auth__left"},T={class:"auth__left_left"},G={class:"auth__logo"},j={class:"auth__right"},q={class:"auth__top"},F={class:"auth__form"},P={class:"form__flex"},W={class:"form__group"},Z={key:0,class:"error text_very"},H={class:"form__group"},J={key:0,class:"error text_very"},K={class:"form__group form__row"},Q={class:"form__buttons"},X=["disabled","loading"],Y={key:0},ss={key:1},Vs=D({__name:"Login",setup(es){const a=w({email:"",password:"",rememberMe:!1}),o=w({email:"",password:""}),_=h(!1),l=h(!1),c=()=>{let t=!0;return o.email="",o.password="",a.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email.trim())||(o.email="Введите корректный email адрес",t=!1):(o.email="Email обязателен для заполнения",t=!1),a.password?a.password.length<6&&(o.password="Пароль должен содержать минимум 6 символов",t=!1):(o.password="Пароль обязателен для заполнения",t=!1),t},R=async()=>{c()&&(l.value=!0,await E("post","/ajax/auth/login.php",{LOGIN:a.email.trim(),PASSWORD:a.password}).then(t=>{console.log("Успешный вход:",t.data),d({message:"Вход выполнен успешно!",type:"success"}),a.email="",a.password="",a.rememberMe=!1,S.push(v.i18nRoute({name:"personal"}))}).catch(t=>{if(console.error("Ошибка при входе:",t),t.response&&t.response.data){const s=t.response.data;s.email&&(o.email=Array.isArray(s.email)?s.email[0]:s.email),s.password&&(o.password=Array.isArray(s.password)?s.password[0]:s.password),!s.email&&!s.password&&s.detail?d({message:s.detail,type:"error"}):!s.email&&!s.password&&s.non_field_errors?d({message:Array.isArray(s.non_field_errors)?s.non_field_errors[0]:s.non_field_errors,type:"error"}):!s.email&&!s.password&&d({message:"Ошибка авторизации. Проверьте введенные данные.",type:"error"})}else t.message?d({message:t.message,type:"error"}):d({message:"Произошла ошибка при подключении к серверу",type:"error"})}).finally(()=>{l.value=!1}))};return(t,s)=>{const b=f("RouterLink"),g=f("el-input"),A=f("el-icon"),C=f("el-checkbox");return n(),m("section",I,[e("div",N,[e("div",U,[e("div",$,[e("div",O,[e("div",T,[e("div",G,[i(z)]),s[6]||(s[6]=e("div",{class:"auth__info"},[e("h3",{class:"auth__heading"},"Стань известным и популярным в мире музыки"),e("p",{class:"auth__description"},"Выложи трек на все площадки и продавай свою музыку во всем мире")],-1))]),s[7]||(s[7]=e("div",{class:"auth__image"},[e("img",{src:L,alt:"cover"})],-1))]),e("div",j,[e("div",q,[s[9]||(s[9]=e("p",{class:"auth__acc text_small"},"У вас нет аккаунта?",-1)),i(b,{class:"auth__login button__second button",to:u(v).i18nRoute({name:"registration"})},{default:p(()=>s[8]||(s[8]=[e("span",null,"Зарегистрироваться",-1)])),_:1},8,["to"])]),e("div",F,[s[13]||(s[13]=e("div",{class:"form__heading"},[e("h1",{class:"form__head title_two"},"Вход")],-1)),e("div",P,[e("div",W,[s[10]||(s[10]=e("label",{for:"email",class:"form__label button"},"E-mail",-1)),i(g,{id:"email",modelValue:a.email,"onUpdate:modelValue":s[0]||(s[0]=r=>a.email=r),type:"email",class:y({error:o.email}),placeholder:"Введите ваш e-mail",disabled:l.value,onBlur:c,onInput:s[1]||(s[1]=r=>o.email=""),size:"large"},null,8,["modelValue","class","disabled"]),o.email?(n(),m("div",Z,k(o.email),1)):V("",!0)]),e("div",H,[s[11]||(s[11]=e("label",{for:"password",class:"form__label button"},"Пароль",-1)),i(g,{id:"password",modelValue:a.password,"onUpdate:modelValue":s[3]||(s[3]=r=>a.password=r),type:_.value?"text":"password",class:y({error:o.password}),placeholder:"Введите пароль",disabled:l.value,onBlur:c,onInput:s[4]||(s[4]=r=>o.password=""),size:"large"},{suffix:p(()=>[i(A,{onClick:s[2]||(s[2]=r=>_.value=!_.value),style:{color:"var(--el-text-color-placeholder)"}},{default:p(()=>[_.value?(n(),x(u(B),{key:0})):(n(),x(u(M),{key:1}))]),_:1})]),_:1},8,["modelValue","type","class","disabled"]),o.password?(n(),m("div",J,k(o.password),1)):V("",!0)]),e("div",K,[i(C,{modelValue:a.rememberMe,"onUpdate:modelValue":s[5]||(s[5]=r=>a.rememberMe=r),disabled:l.value,label:"Запомнить меня",size:"large"},null,8,["modelValue","disabled"]),i(b,{class:"auth__forgot button__second button",to:u(v).i18nRoute({name:"restore"})},{default:p(()=>s[12]||(s[12]=[e("span",null,"Забыли пароль?",-1)])),_:1},8,["to"])])]),e("div",Q,[e("button",{class:"form__send button__black button",onClick:R,disabled:l.value,loading:l.value},[l.value?(n(),m("span",ss,"Загрузка...")):(n(),m("span",Y,"Войти"))],8,X)])])])])])])])}}});export{Vs as default};
